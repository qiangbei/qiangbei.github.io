
## IDS 逃逸技术

产生: 1998年提出的分片逃逸,开始出现IDS的逃逸技术.

### 网络层逃逸

 IP层的ip分片机制导致的逃逸主要有: 碎片化、分片重叠 、分片超时。TCP层同样存在！！！

1、碎片化：主要讲IP报文分层多个ip碎片进行发送。有的ids对分片处理不好，组装不成功则可以达到攻击的效果。工具:fragroute

2、分片重叠技术：分片重叠由于操作系统不同存在俩种算法，frag_old  frag_new ,新的分片覆盖老的。或者相反。由于此，IDS只能选择其一，那么就会造成IDS与后面主机的不一致。规避办法，拒绝分片重叠数据，丢弃。--或者获取主机信息。或者安装主机IDS.工具:fragroute  fragtest

3、分片超时攻击：通过发送分片报文，由于IDS的资源有限，会在一定时间老花掉分片，如果此时在IDS老化掉改报文，而主机还未老化的情形下发送下一个分片，则会导致IDS与主机信息的不一致。以此主机获取了完整的攻击报文，被攻击，而IDS由于报文的老化，重组失败未能获取到攻击。还有另外一种TTL的方式，采用TTL到达IDS，被IDS获取，而部分报文没有到达主机，从而使俩者的获取信息不一致，混淆IDS，而主机获取到完整攻击。--实现不易

### 应用层逃逸

 编码混淆、载荷变换、应用与协议的特性

1、编码混淆，1、采用IDS没有的编码机制 2、编码多态 -- 每一种编码细节的细微变换。

2、载荷变换 -- 使特征匹配失效：1、大小写 2、路径变换  ./ // ../  3、URL参数编码  字符串转义   

3、应用或协议: 针对特定应用的IDS支持的差异，如http的请求管道可以携带多个URL，而IDS只是支持第一个URL,后续无条件通过。

4、多态shellcode  

### 其他逃逸的方式

1、拒绝服务的方式，采取如snot、stick的方式发送大量的模拟攻击，淹没IDS ，导致隐藏真实的攻击可能性。

2、加密的方式

### 不同的安全厂家对于此的检测手段不同:

如Stonesoft公司提出“全协议解析”的解决方法，即对所有协议解析进行标准化检验，不符合协议标准的就“丢弃”。

虽然可以减少重叠、填充、分片过小等带来的问题，但这会因为线路质量不好时，造成大量业务重传或中断，治标而没治本。(启明星辰对STONESOFT的评价)

其他一些安全厂家则提出结合APT的技术，采用了“沙箱”技术，诱使恶意代码露出原形，从而实现对未知攻击的防御。


